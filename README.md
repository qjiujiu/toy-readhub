### 图书馆的管理系统
#### 产品形态(假设我们真的有)
- 线下机器借阅
  - 图书检索
  - 直接借阅
  - 直接归还
- 线上Web/App/小程序
  - 图书检索
  - 只有线上预约的功能(借书必须去线下)，但是每个人一天最多预约一本书，避免过度预约。

#### 接口层
- 学生
  - 图书借阅(必须要在线下刷机器，学生刷卡的时候相当于自动登录拿到 token 完成了鉴权)
  - 图书预约(但是预约可以预约还未归还的图书，并且如果已经抢先预约，则借书的那个同学就无法续借了)
  - 图书续借(一本书最多续借两次)
  - 图书归还(不做任何权限校验，还书是不用刷卡的，方便让人帮忙还书)
  - 查看推荐借阅的书单 (根据学生关联的课程表进行借阅推送，以及根据兴趣偏好进行推荐，这个不先实现)
- 管理员
  - 查看某本图书的借阅情况
  - 查看某个学生的借阅情况
  - 修改借阅订单(主要是用在挂失上面，如果用户不小心把书弄丢了，要把状态从已借出改成已丢失)

#### 业务层
- 学生
  - 图书借阅(以下是借书的整个业务逻辑)
    1. 用户是否被限制借阅?
    2. 用户是否已经超出最大借阅数量?(如果没有学生的信息里面没有记录，则需查询订单表)，用户是否已经借阅了相同的图书?(给出warning，但是仍然允许借阅)
    3. 已经条件均满足，允许借书
    4. 库存锁定(以免其它人线上预约抢占了这本书)
    5. 记录借书时间、计算归还时间
    6. 完成借书
  - 图书预约 (预约的基本流程与借阅基本是一样的，要看有没有限制预约，多次预约但是没有按时去拿会被限制)·每个人能预约的数量有限，以免过度预约
  - 图书续借(需要线上app完成续借)
  - 图书归还
- 管理员
  - 查看某本图书的借阅情况
  - 更新订单状态
  - 更新学生状态(多次弄丢图书会变成失信状态，如果用户交付罚款，管理员可以帮忙重置)

#### 数据层 (这是最快实现的一层，就是增删改查)
- 图书表 (静态信息，多读少改，因为图书录入基本就不怎么修改了)
- 学生表(静态信息，多读少改，同理)
- 库存信息 (动态信息，频繁更新，期末周会有高并发，最高1.2W QPS，可能会一堆人抢马原书籍，要做高并发控制)
- 订单表 (动态信息，频繁更新，仅保存最近三个月的订单记录，设置定时任务，定期删掉过时的订单信息)
